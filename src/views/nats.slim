ruby:
  api = %w{
  $JS.API.INFO
  $JS.API.STREAM.LIST
  $JS.API.STREAM.NAMES

  $JS.API.STREAM.TEMPLATE.NAMES
  $SRV.PING
  $SRV.STATS
  $SRV.INFO

  }

h2 Nats
- api.each do |a|
  h3 = a
  - msg = $nats_client.request(a).data rescue  "{}"
  pre = JSON.pretty_generate JSON(msg)

h2 Services
ruby:
  services = []
  inbox = $nats_client.new_inbox

  sub = $nats_client.subscribe inbox, & -> { services << JSON(_1.data) }

  $nats_client.publish '$SRV.PING', '', inbox
  $nats_client.publish '$SRV.STATS', '', inbox
  $nats_client.publish '$SRV.INFO', '', inbox

  $nats_client.publish '$SYS.REQ.SERVER.PING', '', inbox
  $nats_client.publish '$SYS.REQ.SERVER.INFO', '', inbox
  $nats_client.publish '$SYS.REQ.SERVER.STATS', '', inbox

  $nats_client.publish '$SYS.REQ.SERVER.CONNZ', '', inbox
  $nats_client.publish '$SYS.REQ.SERVER.CONNZ.1', '', inbox

  $nats_client.publish '$SYS.REQ.SERVER.SUBSZ', '', inbox
  $nats_client.publish '$SYS.REQ.SERVER.SUBSZ.1', '', inbox

  $nats_client.publish '$SYS.REQ.SERVER.ROUTEZ', '', inbox

  $nats_client.publish '$SYS.REQ.SERVER.SUBJECTS', '', inbox
  $nats_client.publish '$SYS.REQ.STATS.SUBJECTS', '', inbox
  $nats_client.publish '$SYS.REQ.ACCOUNT.SUBJECTS', '', inbox
  $nats_client.publish '$SYS.REQ.SERVER.SUBLIST', '', inbox

  sleep(3)
  sub.unsubscribe

pre = JSON.pretty_generate services

ruby:
  ## For specific service info
  #PUB $SRV.INFO.< service - name > 0
  #
  #-`$SRV.PING|STATS|INFO` - pings and retrieves status for all services
  #-`$SRV.PING|STATS|INFO.<name>` - pings or retrieves status for all services having the specified name
  #-`$SRV.PING|STATS|INFO.<name>.<id>` - pings or retrieves status of a particular service instance
